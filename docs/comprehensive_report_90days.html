
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>入院管理総合レポート - 90日間分析</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .period {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .nav-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        .nav-button {
            display: inline-block;
            padding: 10px 20px;
            margin: 5px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .nav-button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        .section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric-card {
            background: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .metric-card h3 {
            font-size: 0.9em;
            color: #718096;
            margin-bottom: 5px;
        }
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #2d3748;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }
        tr:hover {
            background: #f7fafc;
        }
        .print-button {
            display: inline-block;
            padding: 15px 30px;
            background: #48bb78;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            margin: 20px auto;
            display: block;
            width: fit-content;
            cursor: pointer;
        }
        @media print {
            .nav-section, .print-button {
                display: none;
            }
            .section {
                page-break-inside: avoid;
            }
        }
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏥 入院管理総合レポート</h1>
            <p class="period">分析期間: 2025年03月20日 - 2025年06月18日 (90日間)</p>
        </div>
        
        <div class="nav-section">
            <a href="#overall" class="nav-button">全体分析</a>
            <a href="#department" class="nav-button">診療科別分析</a>
            <a href="#ward" class="nav-button">病棟別分析</a>
        </div>
        
        <div id="overall" class="section">
            <h2>📊 全体分析</h2>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>平均在院患者数</h3>
                    <div class="metric-value">539.6</div>
                </div>
                <div class="metric-card">
                    <h3>総入院患者数</h3>
                    <div class="metric-value">2,577</div>
                </div>
                <div class="metric-card">
                    <h3>総退院患者数</h3>
                    <div class="metric-value">4,339</div>
                </div>
                <div class="metric-card">
                    <h3>平均在院日数</h3>
                    <div class="metric-value">11.3日</div>
                </div>
            </div>
            
            <h3>入院患者数推移（90日間）</h3>
            <div class="chart-container">
                <canvas id="timeSeriesChart"></canvas>
            </div>
        </div>
        
        <div id="department" class="section">
            <h2>🏥 診療科別分析</h2>
            
            <h3>診療科別実績（90日間）</h3>
            <table>
                <thead>
                    <tr>
                        <th>診療科</th>
                        <th>平均在院患者数</th>
                        <th>総入院患者数</th>
                        <th>総退院患者数</th>
                        <th>推定平均在院日数</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>血液内科</td>
                        <td>12.4</td>
                        <td>130</td>
                        <td>146</td>
                        <td>7.6日</td>
                    </tr>
                    <tr>
                        <td>産婦人科</td>
                        <td>7.9</td>
                        <td>272</td>
                        <td>383</td>
                        <td>1.9日</td>
                    </tr>
                    <tr>
                        <td>整形外科</td>
                        <td>6.8</td>
                        <td>299</td>
                        <td>375</td>
                        <td>1.6日</td>
                    </tr>
                    <tr>
                        <td>総合内科</td>
                        <td>6.7</td>
                        <td>30</td>
                        <td>397</td>
                        <td>1.5日</td>
                    </tr>
                    <tr>
                        <td>一般消化器外科</td>
                        <td>4.8</td>
                        <td>223</td>
                        <td>316</td>
                        <td>1.4日</td>
                    </tr>
                    <tr>
                        <td>小児科</td>
                        <td>4.4</td>
                        <td>60</td>
                        <td>321</td>
                        <td>1.2日</td>
                    </tr>
                    <tr>
                        <td>呼吸器内科</td>
                        <td>4.1</td>
                        <td>125</td>
                        <td>238</td>
                        <td>1.6日</td>
                    </tr>
                    <tr>
                        <td>脳神経外科</td>
                        <td>4.1</td>
                        <td>25</td>
                        <td>55</td>
                        <td>6.7日</td>
                    </tr>
                    <tr>
                        <td>消化器内科</td>
                        <td>3.9</td>
                        <td>178</td>
                        <td>346</td>
                        <td>1.0日</td>
                    </tr>
                    <tr>
                        <td>循環器内科</td>
                        <td>3.8</td>
                        <td>160</td>
                        <td>305</td>
                        <td>1.1日</td>
                    </tr>
                    <tr>
                        <td>心臓血管外科</td>
                        <td>3.6</td>
                        <td>17</td>
                        <td>29</td>
                        <td>11.2日</td>
                    </tr>
                    <tr>
                        <td>脳神経内科</td>
                        <td>3.6</td>
                        <td>7</td>
                        <td>75</td>
                        <td>4.3日</td>
                    </tr>
                    <tr>
                        <td>泌尿器科</td>
                        <td>3.3</td>
                        <td>313</td>
                        <td>338</td>
                        <td>0.9日</td>
                    </tr>
                    <tr>
                        <td>乳腺外科</td>
                        <td>2.5</td>
                        <td>148</td>
                        <td>151</td>
                        <td>1.5日</td>
                    </tr>
                    <tr>
                        <td>リウマチ膠原病内科</td>
                        <td>2.4</td>
                        <td>22</td>
                        <td>48</td>
                        <td>4.5日</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 style="margin-top: 30px;">診療科別在院患者数（上位10診療科）</h3>
            <div class="chart-container">
                <canvas id="deptChart"></canvas>
            </div>
        </div>
        
        <div id="ward" class="section">
            <h2>🛏️ 病棟別分析</h2>
            
            <h3>病棟別実績（90日間）</h3>
            <table>
                <thead>
                    <tr>
                        <th>病棟</th>
                        <th>平均在院患者数</th>
                        <th>総入院患者数</th>
                        <th>総退院患者数</th>
                        <th>推定稼働率</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>02B</td>
                        <td>6.3</td>
                        <td>194</td>
                        <td>276</td>
                        <td>12.6%</td>
                    </tr>
                    <tr>
                        <td>05A</td>
                        <td>5.5</td>
                        <td>364</td>
                        <td>576</td>
                        <td>11.0%</td>
                    </tr>
                    <tr>
                        <td>09B</td>
                        <td>5.2</td>
                        <td>164</td>
                        <td>295</td>
                        <td>10.4%</td>
                    </tr>
                    <tr>
                        <td>07A</td>
                        <td>4.8</td>
                        <td>290</td>
                        <td>365</td>
                        <td>9.6%</td>
                    </tr>
                    <tr>
                        <td>06A</td>
                        <td>4.7</td>
                        <td>210</td>
                        <td>327</td>
                        <td>9.4%</td>
                    </tr>
                    <tr>
                        <td>06B</td>
                        <td>4.7</td>
                        <td>224</td>
                        <td>355</td>
                        <td>9.4%</td>
                    </tr>
                    <tr>
                        <td>03A</td>
                        <td>4.3</td>
                        <td>347</td>
                        <td>473</td>
                        <td>8.6%</td>
                    </tr>
                    <tr>
                        <td>02A</td>
                        <td>4.2</td>
                        <td>151</td>
                        <td>318</td>
                        <td>8.4%</td>
                    </tr>
                    <tr>
                        <td>08A</td>
                        <td>3.9</td>
                        <td>107</td>
                        <td>251</td>
                        <td>7.8%</td>
                    </tr>
                    <tr>
                        <td>04B</td>
                        <td>3.7</td>
                        <td>90</td>
                        <td>207</td>
                        <td>7.4%</td>
                    </tr>
                    <tr>
                        <td>05B</td>
                        <td>3.7</td>
                        <td>142</td>
                        <td>396</td>
                        <td>7.4%</td>
                    </tr>
                    <tr>
                        <td>08B</td>
                        <td>3.6</td>
                        <td>19</td>
                        <td>37</td>
                        <td>7.2%</td>
                    </tr>
                    <tr>
                        <td>07B</td>
                        <td>2.1</td>
                        <td>131</td>
                        <td>206</td>
                        <td>4.2%</td>
                    </tr>
                    <tr>
                        <td>04A</td>
                        <td>2.0</td>
                        <td>0</td>
                        <td>36</td>
                        <td>4.0%</td>
                    </tr>
                    <tr>
                        <td>04C</td>
                        <td>1.6</td>
                        <td>5</td>
                        <td>44</td>
                        <td>3.2%</td>
                    </tr>
                </tbody>
            </table>
            
            <h3 style="margin-top: 30px;">病棟別在院患者数（上位10病棟）</h3>
            <div class="chart-container">
                <canvas id="wardChart"></canvas>
            </div>
        </div>
        
        <button class="print-button" onclick="window.print()">📥 PDFとして保存（印刷）</button>
    </div>
    
    <script>
        // 時系列グラフ
        const timeSeriesCtx = document.getElementById('timeSeriesChart').getContext('2d');
        new Chart(timeSeriesCtx, {
            type: 'line',
            data: {
                labels: ["2025-03-20", "2025-03-21", "2025-03-22", "2025-03-23", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-29", "2025-03-30", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-03", "2025-04-04", "2025-04-05", "2025-04-06", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-12", "2025-04-13", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-18", "2025-04-19", "2025-04-20", "2025-04-21", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-26", "2025-04-27", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-01", "2025-05-02", "2025-05-03", "2025-05-04", "2025-05-05", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-10", "2025-05-11", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-17", "2025-05-18", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-24", "2025-05-25", "2025-05-26", "2025-05-27", "2025-05-28", "2025-05-29", "2025-05-30", "2025-05-31", "2025-06-01", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-07", "2025-06-08", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-14", "2025-06-15", "2025-06-16", "2025-06-17", "2025-06-18"],
                datasets: [{
                    label: '在院患者数',
                    data: [552.0, 551.0, 511.0, 516.0, 542.0, 556.0, 576.0, 569.0, 557.0, 501.0, 499.0, 516.0, 519.0, 548.0, 573.0, 567.0, 526.0, 526.0, 573.0, 576.0, 585.0, 579.0, 562.0, 520.0, 526.0, 567.0, 565.0, 583.0, 574.0, 558.0, 523.0, 518.0, 557.0, 573.0, 589.0, 602.0, 594.0, 542.0, 533.0, 543.0, 531.0, 545.0, 552.0, 536.0, 497.0, 481.0, 467.0, 488.0, 536.0, 556.0, 545.0, 500.0, 499.0, 561.0, 579.0, 597.0, 590.0, 548.0, 505.0, 516.0, 552.0, 573.0, 584.0, 583.0, 572.0, 518.0, 496.0, 537.0, 563.0, 564.0, 560.0, 537.0, 480.0, 489.0, 512.0, 528.0, 543.0, 545.0, 524.0, 475.0, 468.0, 510.0, 524.0, 553.0, 551.0, 519.0, 472.0, 478.0, 521.0, 540.0, 558.0],
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    borderWidth: 2
                }, {
                    label: '新入院患者数',
                    data: [26.0, 21.0, 1.0, 17.0, 42.0, 34.0, 43.0, 35.0, 18.0, 2.0, 16.0, 30.0, 41.0, 42.0, 32.0, 16.0, 1.0, 19.0, 51.0, 42.0, 37.0, 28.0, 13.0, 2.0, 13.0, 50.0, 38.0, 41.0, 24.0, 10.0, 2.0, 17.0, 54.0, 44.0, 51.0, 46.0, 21.0, 2.0, 19.0, 29.0, 29.0, 46.0, 38.0, 14.0, 1.0, 1.0, 1.0, 30.0, 48.0, 44.0, 20.0, 1.0, 22.0, 54.0, 50.0, 50.0, 37.0, 11.0, 2.0, 19.0, 55.0, 50.0, 45.0, 35.0, 20.0, 1.0, 21.0, 52.0, 38.0, 36.0, 34.0, 28.0, 1.0, 18.0, 38.0, 49.0, 39.0, 39.0, 12.0, 0.0, 16.0, 48.0, 41.0, 49.0, 41.0, 15.0, 1.0, 27.0, 50.0, 43.0, 47.0],
                    borderColor: '#48bb78',
                    backgroundColor: 'rgba(72, 187, 120, 0.1)',
                    borderWidth: 2
                }, {
                    label: '退院患者数',
                    data: [35.0, 44.0, 51.0, 29.0, 35.0, 46.0, 50.0, 58.0, 55.0, 63.0, 31.0, 32.0, 53.0, 36.0, 33.0, 48.0, 60.0, 25.0, 30.0, 62.0, 47.0, 60.0, 58.0, 56.0, 25.0, 31.0, 65.0, 48.0, 48.0, 48.0, 53.0, 30.0, 38.0, 52.0, 52.0, 56.0, 57.0, 66.0, 40.0, 56.0, 53.0, 51.0, 56.0, 56.0, 55.0, 29.0, 27.0, 22.0, 31.0, 55.0, 49.0, 65.0, 35.0, 25.0, 50.0, 53.0, 67.0, 76.0, 53.0, 26.0, 36.0, 60.0, 62.0, 49.0, 62.0, 64.0, 56.0, 36.0, 37.0, 60.0, 59.0, 69.0, 67.0, 12.0, 38.0, 51.0, 40.0, 57.0, 50.0, 55.0, 39.0, 33.0, 48.0, 34.0, 68.0, 69.0, 64.0, 33.0, 38.0, 47.0, 50.0],
                    borderColor: '#f6ad55',
                    backgroundColor: 'rgba(246, 173, 85, 0.1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        
        // 診療科別グラフ
        const deptData = {"\u8840\u6db2\u5185\u79d1": 12.4, "\u7523\u5a66\u4eba\u79d1": 7.9, "\u6574\u5f62\u5916\u79d1": 6.8, "\u7dcf\u5408\u5185\u79d1": 6.7, "\u4e00\u822c\u6d88\u5316\u5668\u5916\u79d1": 4.8, "\u5c0f\u5150\u79d1": 4.4, "\u547c\u5438\u5668\u5185\u79d1": 4.1, "\u8133\u795e\u7d4c\u5916\u79d1": 4.1, "\u6d88\u5316\u5668\u5185\u79d1": 3.9, "\u5faa\u74b0\u5668\u5185\u79d1": 3.8};
        const deptCtx = document.getElementById('deptChart').getContext('2d');
        new Chart(deptCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(deptData),
                datasets: [{
                    label: '平均在院患者数',
                    data: Object.values(deptData),
                    backgroundColor: '#667eea'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
        
        // 病棟別グラフ
        const wardData = {"02B": 6.3, "05A": 5.5, "09B": 5.2, "07A": 4.8, "06A": 4.7, "06B": 4.7, "03A": 4.3, "02A": 4.2, "08A": 3.9, "04B": 3.7};
        const wardCtx = document.getElementById('wardChart').getContext('2d');
        new Chart(wardCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(wardData),
                datasets: [{
                    label: '平均在院患者数',
                    data: Object.values(wardData),
                    backgroundColor: '#764ba2'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
        
        // スムーススクロール
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>