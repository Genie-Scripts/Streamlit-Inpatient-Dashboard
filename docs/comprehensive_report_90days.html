
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>入院管理総合レポート - 90日間分析</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif; background: #f5f5f5; color: #333; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .period { font-size: 1.2em; opacity: 0.9; }
        .nav-section { background: white; padding: 15px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        .nav-button { display: inline-block; padding: 10px 20px; margin: 5px; background: #667eea; color: white; text-decoration: none; border-radius: 5px; transition: all 0.3s; }
        .nav-button:hover { background: #5a67d8; transform: translateY(-2px); }
        .section { background: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .section h2 { color: #667eea; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .metric-card { background: #f7fafc; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }
        .metric-card h3 { font-size: 0.9em; color: #718096; margin-bottom: 5px; }
        .metric-value { font-size: 2em; font-weight: bold; color: #2d3748; }
        .chart-container { position: relative; height: 400px; margin-top: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; }
        th { background: #f7fafc; font-weight: 600; color: #4a5568; text-align: center; }
        td:first-child { font-weight: 500; }
        td:not(:first-child) { text-align: right; }
        tr:hover { background: #f7fafc; }
        .print-button { display: block; width: fit-content; margin: 20px auto; padding: 15px 30px; background: #48bb78; color: white; text-decoration: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
        @media print { .nav-section, .print-button { display: none; } .section { page-break-inside: avoid; } }
        @media (max-width: 768px) { .header h1 { font-size: 1.8em; } .metrics-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏥 入院管理総合レポート</h1>
            <p class="period">分析期間: 2025年03月21日 - 2025年06月18日 (90日間)</p>
        </div>
        <div class="nav-section">
            <a href="#overall" class="nav-button">全体分析</a> <a href="#department" class="nav-button">診療科別分析</a> <a href="#ward" class="nav-button">病棟別分析</a>
        </div>
        
        <div id="overall" class="section">
            <h2>📊 全体分析</h2>
            <div class="metrics-grid">
                <div class="metric-card"><h3>平均在院患者数</h3><div class="metric-value">539.5</div></div>
                <div class="metric-card"><h3>総入院患者数</h3><div class="metric-value">4,513</div></div>
                <div class="metric-card"><h3>総退院患者数</h3><div class="metric-value">4,507</div></div>
                <div class="metric-card"><h3>平均在院日数</h3><div class="metric-value">10.8日</div></div>
            </div>
            <h3>入院患者数推移（90日間）</h3>
            <div class="chart-container"><canvas id="timeSeriesChart"></canvas></div>
        </div>
        
        <div id="department" class="section">
            <h2>🏥 診療科別分析</h2>
            <h3>診療科別 平均在院患者数</h3>
            <table><thead><tr><th>診療科</th><th>直近7日</th><th>直近14日</th><th>直近30日</th><th>直近60日</th><th>90日間</th></tr></thead><tbody><tr><td>総合内科</td><td>80.9</td><td>82.6</td><td>85.9</td><td>89.8</td><td>94.4</td></tr><tr><td>整形外科</td><td>55.1</td><td>53.9</td><td>54.6</td><td>57.4</td><td>59.8</td></tr><tr><td>呼吸器内科</td><td>43.3</td><td>42.6</td><td>42.4</td><td>44.6</td><td>44.1</td></tr><tr><td>消化器内科</td><td>39.6</td><td>41.2</td><td>42.6</td><td>41.9</td><td>42.3</td></tr><tr><td>一般消化器外科</td><td>38.0</td><td>40.7</td><td>42.7</td><td>40.1</td><td>41.2</td></tr><tr><td>循環器内科</td><td>32.1</td><td>32.0</td><td>34.2</td><td>34.1</td><td>34.4</td></tr><tr><td>産婦人科</td><td>29.7</td><td>28.4</td><td>29.9</td><td>28.4</td><td>27.6</td></tr><tr><td>血液内科</td><td>28.1</td><td>26.7</td><td>25.3</td><td>26.1</td><td>25.9</td></tr><tr><td>泌尿器科</td><td>25.4</td><td>25.2</td><td>26.6</td><td>25.1</td><td>23.2</td></tr><tr><td>救急科</td><td>16.6</td><td>17.6</td><td>19.1</td><td>21.8</td><td>22.1</td></tr><tr><td>脳神経内科</td><td>19.6</td><td>18.9</td><td>17.4</td><td>16.0</td><td>16.7</td></tr><tr><td>小児科</td><td>16.1</td><td>13.8</td><td>14.3</td><td>14.7</td><td>14.3</td></tr><tr><td>リウマチ膠原病内科</td><td>9.3</td><td>9.6</td><td>12.3</td><td>13.6</td><td>13.2</td></tr><tr><td>腎内科</td><td>11.1</td><td>10.4</td><td>10.9</td><td>12.5</td><td>13.0</td></tr><tr><td>脳神経外科</td><td>16.6</td><td>17.3</td><td>15.6</td><td>13.6</td><td>12.3</td></tr></tbody></table>
            <div class="chart-container"><canvas id="deptChart"></canvas></div>
        </div>
        
        <div id="ward" class="section">
            <h2>🛏️ 病棟別分析</h2>
            <h3>病棟別 平均在院患者数</h3>
            <table><thead><tr><th>病棟</th><th>直近7日</th><th>直近14日</th><th>直近30日</th><th>直近60日</th><th>90日間</th></tr></thead><tbody><tr><td>09B</td><td>44.7</td><td>45.1</td><td>45.8</td><td>45.7</td><td>45.9</td></tr><tr><td>06A</td><td>43.0</td><td>42.6</td><td>44.6</td><td>45.4</td><td>45.9</td></tr><tr><td>06B</td><td>44.1</td><td>43.4</td><td>44.4</td><td>45.0</td><td>45.6</td></tr><tr><td>02B</td><td>44.3</td><td>43.8</td><td>45.1</td><td>45.0</td><td>45.5</td></tr><tr><td>02A</td><td>39.0</td><td>38.7</td><td>40.2</td><td>42.8</td><td>44.1</td></tr><tr><td>08A</td><td>43.6</td><td>41.9</td><td>43.2</td><td>43.7</td><td>43.8</td></tr><tr><td>05A</td><td>42.1</td><td>42.0</td><td>44.0</td><td>43.6</td><td>43.6</td></tr><tr><td>03A</td><td>39.3</td><td>39.6</td><td>41.4</td><td>42.1</td><td>42.5</td></tr><tr><td>07A</td><td>40.3</td><td>40.2</td><td>41.4</td><td>41.7</td><td>41.6</td></tr><tr><td>05B</td><td>32.6</td><td>30.6</td><td>32.4</td><td>34.1</td><td>34.9</td></tr><tr><td>04B</td><td>4.9</td><td>5.4</td><td>17.9</td><td>28.6</td><td>31.9</td></tr><tr><td>07B</td><td>25.4</td><td>26.1</td><td>26.9</td><td>26.7</td><td>26.9</td></tr><tr><td>04C</td><td>15.1</td><td>15.9</td><td>15.9</td><td>16.9</td><td>17.1</td></tr><tr><td>09A</td><td>18.0</td><td>17.1</td><td>17.7</td><td>16.9</td><td>17.0</td></tr><tr><td>08B</td><td>38.3</td><td>39.3</td><td>23.0</td><td>11.5</td><td>7.7</td></tr></tbody></table>
            <div class="chart-container"><canvas id="wardChart"></canvas></div>
        </div>
        
        <button class="print-button" onclick="window.print()">📥 PDFとして保存（印刷）</button>
    </div>
    
    <script>
        // Data for charts
        const dailyLabels = ["2025-03-21", "2025-03-22", "2025-03-23", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-29", "2025-03-30", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-03", "2025-04-04", "2025-04-05", "2025-04-06", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-12", "2025-04-13", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-18", "2025-04-19", "2025-04-20", "2025-04-21", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-26", "2025-04-27", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-01", "2025-05-02", "2025-05-03", "2025-05-04", "2025-05-05", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-10", "2025-05-11", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-17", "2025-05-18", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-24", "2025-05-25", "2025-05-26", "2025-05-27", "2025-05-28", "2025-05-29", "2025-05-30", "2025-05-31", "2025-06-01", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-07", "2025-06-08", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-14", "2025-06-15", "2025-06-16", "2025-06-17", "2025-06-18"];
        const dailyInpatients = [551.0, 511.0, 516.0, 542.0, 556.0, 576.0, 569.0, 557.0, 501.0, 499.0, 516.0, 519.0, 548.0, 573.0, 567.0, 526.0, 526.0, 573.0, 576.0, 585.0, 579.0, 562.0, 520.0, 526.0, 567.0, 565.0, 583.0, 574.0, 558.0, 523.0, 518.0, 557.0, 573.0, 589.0, 602.0, 594.0, 542.0, 533.0, 543.0, 531.0, 545.0, 552.0, 536.0, 497.0, 481.0, 467.0, 488.0, 536.0, 556.0, 545.0, 500.0, 499.0, 561.0, 579.0, 597.0, 590.0, 548.0, 505.0, 516.0, 552.0, 573.0, 584.0, 583.0, 572.0, 518.0, 496.0, 537.0, 563.0, 564.0, 560.0, 537.0, 480.0, 489.0, 512.0, 528.0, 543.0, 545.0, 524.0, 475.0, 468.0, 510.0, 524.0, 553.0, 551.0, 519.0, 472.0, 478.0, 521.0, 540.0, 558.0];
        const dailyAdmissions = [43.0, 14.0, 38.0, 64.0, 63.0, 72.0, 57.0, 44.0, 11.0, 31.0, 51.0, 62.0, 59.0, 63.0, 43.0, 21.0, 28.0, 80.0, 65.0, 61.0, 56.0, 41.0, 17.0, 34.0, 75.0, 67.0, 69.0, 44.0, 33.0, 20.0, 25.0, 79.0, 70.0, 70.0, 73.0, 50.0, 17.0, 33.0, 69.0, 41.0, 67.0, 65.0, 40.0, 16.0, 16.0, 14.0, 48.0, 79.0, 76.0, 39.0, 23.0, 35.0, 90.0, 70.0, 75.0, 65.0, 35.0, 14.0, 41.0, 73.0, 83.0, 75.0, 50.0, 54.0, 11.0, 34.0, 79.0, 67.0, 63.0, 56.0, 46.0, 11.0, 22.0, 66.0, 69.0, 56.0, 60.0, 33.0, 12.0, 31.0, 77.0, 65.0, 69.0, 69.0, 38.0, 20.0, 44.0, 81.0, 68.0, 70.0];
        const dailyDischarges = [44.0, 54.0, 33.0, 36.0, 48.0, 54.0, 63.0, 57.0, 64.0, 36.0, 33.0, 54.0, 36.0, 38.0, 49.0, 61.0, 28.0, 33.0, 63.0, 51.0, 61.0, 59.0, 58.0, 29.0, 35.0, 67.0, 53.0, 51.0, 51.0, 55.0, 31.0, 39.0, 55.0, 54.0, 59.0, 58.0, 69.0, 41.0, 59.0, 55.0, 53.0, 58.0, 56.0, 55.0, 31.0, 27.0, 28.0, 32.0, 56.0, 50.0, 67.0, 37.0, 28.0, 51.0, 57.0, 72.0, 78.0, 56.0, 31.0, 37.0, 61.0, 64.0, 51.0, 64.0, 67.0, 56.0, 39.0, 40.0, 61.0, 59.0, 71.0, 68.0, 13.0, 43.0, 53.0, 42.0, 58.0, 53.0, 58.0, 40.0, 37.0, 51.0, 39.0, 69.0, 73.0, 65.0, 36.0, 42.0, 50.0, 50.0];
        const deptChartData = {"\u7dcf\u5408\u5185\u79d1": 94.41111111111111, "\u6574\u5f62\u5916\u79d1": 59.8, "\u547c\u5438\u5668\u5185\u79d1": 44.1, "\u6d88\u5316\u5668\u5185\u79d1": 42.27777777777778, "\u4e00\u822c\u6d88\u5316\u5668\u5916\u79d1": 41.15555555555556, "\u5faa\u74b0\u5668\u5185\u79d1": 34.422222222222224, "\u7523\u5a66\u4eba\u79d1": 27.58888888888889, "\u8840\u6db2\u5185\u79d1": 25.855555555555554, "\u6ccc\u5c3f\u5668\u79d1": 23.244444444444444, "\u6551\u6025\u79d1": 22.1, "\u8133\u795e\u7d4c\u5185\u79d1": 16.7, "\u5c0f\u5150\u79d1": 14.322222222222223, "\u30ea\u30a6\u30de\u30c1\u81a0\u539f\u75c5\u5185\u79d1": 13.155555555555555, "\u814e\u5185\u79d1": 13.044444444444444, "\u8133\u795e\u7d4c\u5916\u79d1": 12.322222222222223};
        const wardChartData = {"09B": 45.9, "06A": 45.87777777777778, "06B": 45.6, "02B": 45.53333333333333, "02A": 44.05555555555556, "08A": 43.833333333333336, "05A": 43.577777777777776, "03A": 42.455555555555556, "07A": 41.62222222222222, "05B": 34.922222222222224, "04B": 31.91111111111111, "07B": 26.91111111111111, "04C": 17.122222222222224, "09A": 16.977777777777778, "08B": 7.655555555555556};
        
        // Time Series Chart
        new Chart(document.getElementById('timeSeriesChart'), {
            type: 'line', data: { labels: dailyLabels, datasets: [
                { label: '在院患者数', data: dailyInpatients, borderColor: '#667eea', backgroundColor: 'rgba(102, 126, 234, 0.1)', borderWidth: 2, tension: 0.1 },
                { label: '新入院患者数', data: dailyAdmissions, borderColor: '#48bb78', backgroundColor: 'rgba(72, 187, 120, 0.1)', borderWidth: 2, tension: 0.1 },
                { label: '退院患者数', data: dailyDischarges, borderColor: '#f6ad55', backgroundColor: 'rgba(246, 173, 85, 0.1)', borderWidth: 2, tension: 0.1 }
            ]}, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } } }
        });
        
        // Department Chart
        new Chart(document.getElementById('deptChart'), {
            type: 'bar', data: { labels: Object.keys(deptChartData), datasets: [{ label: '平均在院患者数 (90日間)', data: Object.values(deptChartData), backgroundColor: '#667eea' }] },
            options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } } }
        });
        
        // Ward Chart
        new Chart(document.getElementById('wardChart'), {
            type: 'bar', data: { labels: Object.keys(wardChartData), datasets: [{ label: '平均在院患者数 (90日間)', data: Object.values(wardChartData), backgroundColor: '#764ba2' }] },
            options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } } }
        });
        
        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) { e.preventDefault(); document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' }); });
        });
    </script>
</body>
</html>